import{_ as s,c as i,o as a,a5 as n}from"./chunks/framework.BuWuHeYF.js";const u=JSON.parse('{"title":"Codepresso ëŸ¬ë„ˆí†¤ ë„ì „ê¸° - Week 2. ëŸ¬ë„ˆë¸”(Runnable)ê³¼ í”„ë¡¬í”„íŠ¸","description":"ë­ì²´ì¸ ëŸ¬ë„ˆë¸”ê³¼ í”„ë¡¬í”„íŠ¸, few-shot í”„ë¡¬í”„íŠ¸","frontmatter":{"title":"Codepresso ëŸ¬ë„ˆí†¤ ë„ì „ê¸° - Week 2. ëŸ¬ë„ˆë¸”(Runnable)ê³¼ í”„ë¡¬í”„íŠ¸","description":"ë­ì²´ì¸ ëŸ¬ë„ˆë¸”ê³¼ í”„ë¡¬í”„íŠ¸, few-shot í”„ë¡¬í”„íŠ¸","keywords":"\\"LangChain, Runnable, Prompting, LLM\\"","url":"LLM/codepresso/w2.html","img":"https://an-jieun.github.io/static/img/cp-w2.png","tags":"Langchain","lastmod":"2025-03-09T00:00:00.000Z","sitemap":{"changefreq":"daily","priority":0.4},"head":[["script",{"type":"application/ld+json"},"{\\n  \\"@context\\":\\"http://schema.org\\",\\n  \\"@type\\":\\"BlogPosting\\",\\n  \\"mainEntityOfPage\\" : {\\n    \\"@type\\" : \\"WebPage\\",\\n    \\"@id\\" : \\"https://an-jieun.github.io/contentsLLM/codepresso/w2.html\\"\\n  },\\n  \\"image\\" : {\\n    \\"@type\\" : \\"ImageObject\\",\\n    \\"url\\" : \\"https://an-jieun.github.io/static/img/cp-w2.png\\"\\n    \\"width\\" : \\"800px\\",\\n    \\"height\\" : \\"800px\\"\\n  },\\n  \\"name\\":\\"Codepresso ëŸ¬ë„ˆí†¤ ë„ì „ê¸° - Week 2. ëŸ¬ë„ˆë¸”(Runnable)ê³¼ í”„ë¡¬í”„íŠ¸\\",\\n  \\"url\\" : \\"https://an-jieun.github.io/contents/LLM/codepresso/w2.html\\",\\n  \\"headline\\":\\"ë­ì²´ì¸ ëŸ¬ë„ˆë¸”ê³¼ í”„ë¡¬í”„íŠ¸, few-shot í”„ë¡¬í”„íŠ¸\\",\\n  \\"description\\":\\"ë­ì²´ì¸ ëŸ¬ë„ˆë¸”ê³¼ í”„ë¡¬í”„íŠ¸, few-shot í”„ë¡¬í”„íŠ¸\\",\\n  \\"keywords\\" : [\\"LangChain, Runnable, Prompting, LLM\\"],\\n  \\"inLanguage\\":\\"ko\\",\\n  \\"author\\" : {\\n    \\"@type\\" : \\"Person\\",\\n    \\"name\\" : \\"Jieun\\",\\n    \\"email\\" : \\"aje20010827@gmail.com\\"\\n    }\\n  },\\n}"],["meta",{"property":"og:title","content":"Codepresso ëŸ¬ë„ˆí†¤ ë„ì „ê¸° - Week 2. ëŸ¬ë„ˆë¸”(Runnable)ê³¼ í”„ë¡¬í”„íŠ¸"}],["meta",{"property":"og:description","content":"ë­ì²´ì¸ ëŸ¬ë„ˆë¸”ê³¼ í”„ë¡¬í”„íŠ¸, few-shot í”„ë¡¬í”„íŠ¸"}],["meta",{"property":"og:url","content":"https://an-jieun.github.io/"}],["meta",{"property":"og:type","content":"website"}],["meta",{"property":"og:image","content":"https://an-jieun.github.io/static/img/cp-w2.png"}],["meta",{"property":"og:site_name","content":"ì „ìë‘ë‡Œë§Œë“¤ê¸°"}],["meta",{"property":"og:locale","content":"ko_KR"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:title","content":"Codepresso ëŸ¬ë„ˆí†¤ ë„ì „ê¸° - Week 2. ëŸ¬ë„ˆë¸”(Runnable)ê³¼ í”„ë¡¬í”„íŠ¸"}],["meta",{"name":"twitter:description","content":"ë­ì²´ì¸ ëŸ¬ë„ˆë¸”ê³¼ í”„ë¡¬í”„íŠ¸, few-shot í”„ë¡¬í”„íŠ¸"}],["meta",{"name":"twitter:image","content":"https://an-jieun.github.io/static/img/cp-w2.png"}],["meta",{"property":"@context","content":"http://schema.org"}],["meta",{"property":"@type","content":"TechArticle"}],["meta",{"property":"name","content":"Codepresso ëŸ¬ë„ˆí†¤ ë„ì „ê¸° - Week 2. ëŸ¬ë„ˆë¸”(Runnable)ê³¼ í”„ë¡¬í”„íŠ¸"}],["meta",{"property":"url","content":"https://an-jieun.github.io/contents/LLM/codepresso/w2.html"}],["meta",{"property":"description","content":"ë­ì²´ì¸ ëŸ¬ë„ˆë¸”ê³¼ í”„ë¡¬í”„íŠ¸, few-shot í”„ë¡¬í”„íŠ¸"}],["meta",{"property":"keywords","content":"LangChain, Runnable, Prompting, LLM"}],["meta",{"property":"version","content":"1.0"}],["meta",{"property":"inLanguage","content":"ko"}],["meta",{"property":"technicalAudience","content":"developer, DBA, Web Developer"}],["meta",{"property":"proficiencyLevel","content":"beginner"}],["meta",{"property":"author","content":"Jieun"}]]},"headers":[],"relativePath":"contents/LLM/codepresso/w2.md","filePath":"contents/LLM/codepresso/w2.md","lastUpdated":1741610877000}'),p={name:"contents/LLM/codepresso/w2.md"},e=n(`<h1 id="codepresso-á„…á…¥á„‚á…¥á„á…©á†«-á„ƒá…©á„Œá…¥á†«á„€á…µ-week-2-á„…á…¥á„‚á…¥á„‡á…³á†¯-runnable-á„€á…ª-á„‘á…³á„…á…©á†·á„‘á…³á„á…³" tabindex="-1">[Codepresso ëŸ¬ë„ˆí†¤ ë„ì „ê¸°] Week 2. ëŸ¬ë„ˆë¸”(Runnable)ê³¼ í”„ë¡¬í”„íŠ¸ <a class="header-anchor" href="#codepresso-á„…á…¥á„‚á…¥á„á…©á†«-á„ƒá…©á„Œá…¥á†«á„€á…µ-week-2-á„…á…¥á„‚á…¥á„‡á…³á†¯-runnable-á„€á…ª-á„‘á…³á„…á…©á†·á„‘á…³á„á…³" aria-label="Permalink to &quot;[Codepresso ëŸ¬ë„ˆí†¤ ë„ì „ê¸°] Week 2. ëŸ¬ë„ˆë¸”(Runnable)ê³¼ í”„ë¡¬í”„íŠ¸&quot;">â€‹</a></h1><p>ë³¸ ê²Œì‹œë¬¼ì€ í…Œë””ë…¸íŠ¸ì˜ <a href="https://wikidocs.net/book/14314" target="_blank" rel="noreferrer">&lt;ë­ì²´ì¸LangChain ë…¸íŠ¸&gt; - LangChain í•œêµ­ì–´ íŠœí† ë¦¬ì–¼ğŸ‡°ğŸ‡·</a>ë¥¼ ì°¸ê³ í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p><h2 id="runnable" tabindex="-1">Runnable <a class="header-anchor" href="#runnable" aria-label="Permalink to &quot;Runnable&quot;">â€‹</a></h2><p>chainì€ ì˜¤ì§ í´ë˜ìŠ¤ ê°ì²´ë¡œ ì •ì˜ëœ ë³€ìˆ˜(ë˜ëŠ” ìƒì„±ì)ë§Œì„ ì—°ê²°í•  ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ, <code>input()</code>ê³¼ ê°™ì€ ë©”ì„œë“œë¥¼ ì—°ê²°í•˜ëŠ” ê²ƒì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤.</p><p>ê·¸ë ‡ì§€ë§Œ ì²´ì¸ì— ê²°ê³¼ ë¬¸ìì—´ì„ ì „ì²˜ë¦¬í•˜ê±°ë‚˜, ì‚¬ìš©ìì˜ ì…ë ¥ì„ ë°›ê±°ë‚˜, í˜¹ì€ ë‹¤ë¥¸ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•˜ëŠ” ëª¨ë“ˆì„ ì—°ê²°í•´ì•¼ í•  ìƒí™©ì´ ì¡´ì¬í•  ê²ƒì´ë‹¤. íŠ¹íˆ ê·¸ ì²´ì¸ì´ ì±—ë´‡ ì²´ì¸ì¸ ê²½ìš°ì—” ë”ìš± ê·¸ë ‡ë‹¤.</p><p>Runnableì€ ë°”ë¡œ ì´ëŸ° ê²½ìš°ì— í™œìš©í•  ìˆ˜ ìˆë‹¤. ì²´ì¸ ê³¼ì •ì— ë©”ì„œë“œë‚˜ í•¨ìˆ˜ë¥¼ ë„£ì–´ì•¼ í•˜ëŠ” ê²½ìš°, í˜¹ì€ ì…ë ¥ê°’ì„ ë°›ì•„ì™€ì•¼ í•˜ëŠ” ê²½ìš° í•¨ìˆ˜ë‚˜ ë©”ì„œë“œë¥¼ Runnable í´ë˜ìŠ¤ ê°ì²´ë¡œ ì •ì˜í•˜ë„ë¡ í•˜ì—¬ ì²´ì¸ì— ì—°ê²°í•  ìˆ˜ ìˆê²Œ í•œë‹¤.</p><p>ìì£¼ ì“°ì´ëŠ” Runnable í´ë˜ìŠ¤ë¡œëŠ” <code>RunnablePathThrough</code>, <code>RunnableWithMessageHistory</code>, <code>RunnableLambda</code>ê°€ ìˆë‹¤.</p><h3 id="runnablepaththrough" tabindex="-1">RunnablePathThrough <a class="header-anchor" href="#runnablepaththrough" aria-label="Permalink to &quot;RunnablePathThrough&quot;">â€‹</a></h3><p>week1 ì—ì„œë„ ë“±ì¥í•œ í´ë˜ìŠ¤ì´ë‹¤. <code>RunnablePathThrough</code>ëŠ” ì…ë ¥ê°’ì„ ì „ë‹¬í•˜ëŠ” í´ë˜ìŠ¤ì´ë‹¤. ë­ì²´ì¸ ì—…ë°ì´íŠ¸ ì´ì „ <code>chain.invoke()</code>ì—ì„œ input ë³€ìˆ˜ê°€ 1ê°œì¸ ìƒí™©ì—ì„œë„ ë”•ì…”ë„ˆë¦¬ í˜•íƒœë¡œ ê°’ì„ ì „ë‹¬í•´ì•¼ í–ˆëŠ”ë°, <code>RunnablePathThrough</code>ë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ <code>.invoke</code>ì— ë°”ë¡œ ì…ë ¥ê°’ì„ ì „ë‹¬í•  ìˆ˜ ìˆì—ˆë‹¤.</p><h3 id="runnablewithmessagehistory" tabindex="-1">RunnableWithMessageHistory <a class="header-anchor" href="#runnablewithmessagehistory" aria-label="Permalink to &quot;RunnableWithMessageHistory&quot;">â€‹</a></h3><p>ì±—ë´‡ì€ ë°©ê¸ˆ ë‚˜ëˆ´ë˜ ëŒ€í™” ë‚´ìš©ì„ ëª¨ë‘ ê¸°ì–µí•˜ê³  ìˆì–´ì•¼ í•˜ê³ , ì´ì „ ëŒ€í™” ë‚´ìš©ì„ ì°¸ê³ í•´ ëŒ€ë‹µí•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤. ê·¸ëŸ¬ë‚˜ ë‹¨ìˆœíˆ <code>.invoke</code>ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒìœ¼ë¡œëŠ” ë¶ˆê°€ëŠ¥í•˜ë©°, chainì— ì´ê²ƒì„ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” í•¨ìˆ˜ë“¤ì„ ì—°ê²°í•˜ì—¬ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì€ ë„ˆë¬´ ì–´ë µê³  ë³µì¡í•˜ë‹¤. ì´ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í´ë˜ìŠ¤ê°€ ë°”ë¡œ <code>RunnableWithMessageHistory</code>ì´ë‹¤.</p><p>RunnableWithMessageHistoryëŠ” ê¸°ë³¸ì ìœ¼ë¡œ í”„ë¡¬í”„íŠ¸ì— ê³¼ê±° ëŒ€í™” ë‚´ì—­ì„ ì‚½ì…í•˜ëŠ” ë°©ì‹ì´ë‹¤. ë”°ë¼ì„œ ê°€ì¥ ë¨¼ì € ëŒ€í™” ë‚´ìš©ì„ &quot;ID&quot; : [ChatMessageHistory] ìŒìœ¼ë¡œ ì €ì¥í•  ìˆ˜ ìˆëŠ” ë”•ì…”ë„ˆë¦¬ íƒ€ì…ì˜ <code>store</code>ë¥¼ ì •ì˜í•´ì•¼ í•œë‹¤.</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">store </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>ê·¸ë¦¬ê³ , <code>store</code>ë¡œë¶€í„° session idë¥¼ ì‚¬ìš©í•´ ëŒ€í™” ë‚´ìš©ì„ ê°€ì ¸ì˜¤ê³ , ë§Œì¼ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ìƒˆë¡œìš´ <code>ChatMessageHistory</code> ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜ê°€ í•„ìš”í•˜ë‹¤.</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_session_history</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(session_id):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> session_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">not</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> store:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        store[session_id] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ChatMessageHistory()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> store[session_id]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>í”„ë¡¬í”„íŠ¸ë¥¼ êµ¬ì„±í•  ë•Œì—ëŠ”, <code>MessagePlaceHolder</code>ë¥¼ ì‚¬ìš©í•´ ëŒ€í™” ë‚´ì—­ì´ ì‚½ì…ë  ì§€ì ì„ ì •ì˜í•œë‹¤.</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prompt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ChatPromptTemplate.from_message(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;system&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ë‹¹ì‹ ì€ k-pop ì•„ì´ëŒì— ëŒ€í•œ ì§ˆë¬¸ì— ëŒ‘ì„ ì£¼ëŠ” ì±—ë´‡ì´ê³ , ì£¼ì–´ì§„ ì»¨í…ìŠ¤íŠ¸(context)ë¥¼ ì°¸ê³ í•˜ì—¬ ë‹µë³€ì„ ìƒì„±í•©ë‹ˆë‹¤.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        MessagePlaceHolder(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">variable_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;chat_histroy&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;human&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ë‹¤ìŒì˜ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì°¸ê³ í•˜ì—¬ ì£¼ì–´ì§„ ì§ˆë¬¸ì— ëŒ€í•œ ë‹µì„ í•˜ì‹œì˜¤.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&lt;context&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{context}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&lt;/context&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&lt;question&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{question}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&lt;/question&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><code>chain</code>ì€ ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì„±í•œë‹¤. í”„ë¡¬í”„íŠ¸ì˜ ë³€ìˆ˜ë“¤ì´ í¬ë§·íŒ… ë  ìˆ˜ ìˆë„ë¡ ë”•ì…”ë„ˆë¦¬ í˜•íƒœë¡œ ë³€ìˆ˜ëª…ê³¼ ê°’ë“¤ì„ ì •ì˜í•˜ëŠ” ë¶€ë¶„ì´ ì œì¼ ì²«ë²ˆì§¸ì— ì˜¤ê²Œ ëœë‹¤.</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">chain </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;context&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : itemgetter(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;question&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> retreiver, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ì…ë ¥ëœ ì§ˆì˜ë¥¼ ë°”íƒ•ìœ¼ë¡œ ê²€ìƒ‰ì„ ìˆ˜í–‰í•´ context ìƒì„±</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;question&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : itemgetter(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;question&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;chat_history&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:itemgetter(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;chat_history&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prompt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">llm</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">StrOutputParser()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><code>RunnableWithMessageHistory</code>ëŠ” ë³„ë„ì˜ ì²´ì¸ í´ë˜ìŠ¤ë¡œ ì‚¬ìš©ëœë‹¤. ë”°ë¼ì„œ, ì•ì„œ ì •ì˜í•œ ì²´ì¸ê³¼ chat history search í•¨ìˆ˜, ê·¸ë¦¬ê³  ì…ë ¥ ë©”ì‹œì§€ì— ëŒ€í•œ í‚¤ ê°’ê³¼ ë©”ì‹œì§€ í‚¤ ê°’ì„ ì •ì˜í•˜ì—¬ RunnableWithMessageHistory chainì„ ìƒì„±í•œë‹¤.</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">chat_histroy_chat </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> RunnableWithMessageHistory(chain, get_session_history, </span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        input_message_key</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;question&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">history_message_key</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;chat_history&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>ì´ë ‡ê²Œ ìƒì„±ëœ ì²´ì¸ì€ ì¼ë°˜ì ì¸ ì²´ì¸ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ <code>.invoke</code>, <code>.stream</code>ë“±ì˜ ë©”ì„œë“œë¡œ ì±„íŒ…ì„ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ ìˆë‹¤. ê·¸ë¦¬ê³  <code>store</code> ê°ì²´ì— ì €ì¥ëœ ëŒ€í™” ë‚´ìš©ì„ í™•ì¸í•  ìˆ˜ë„ ìˆë‹¤.</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">chat_history_chat.invoke({</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;question&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">input</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;User Question : &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="runnablelambda" tabindex="-1">RunnableLambda <a class="header-anchor" href="#runnablelambda" aria-label="Permalink to &quot;RunnableLambda&quot;">â€‹</a></h3><p><code>RunnableLambda</code>ëŠ” ì²´ì¸ì—ì„œ ì‚¬ìš©ì ì •ì˜ í•¨ìˆ˜ë‚˜ ë©”ì„œë“œë¥¼ ì‹¤í–‰ì‹œí‚¨ í›„, ê·¸ ê²°ê³¼ë¥¼ ì…ë ¥ë³€ìˆ˜ë¡œ ì „ë‹¬í•  ë•Œ ì‚¬ìš©í•œë‹¤. <code>RunnableLambda(&lt;í•¨ìˆ˜ ê°ì²´&gt;)</code>ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. RunnableLambdaì˜ êµ¬ì²´ì ì¸ ì‚¬ìš© ì˜ˆì‹œëŠ” í”„ë¡¬í”„íŠ¸ ì±•í„°ì—ì„œ ì„¤ëª…í•˜ë„ë¡ í•˜ê² ë‹¤.</p><h2 id="prompt" tabindex="-1">Prompt <a class="header-anchor" href="#prompt" aria-label="Permalink to &quot;Prompt&quot;">â€‹</a></h2><p>Few-Shot PromptëŠ” ì§ˆë¬¸-ë‹µë³€ ì˜ˆì‹œë¥¼ ì œê³µí•˜ëŠ” ê¸°ë²•ì´ë‹¤. ì˜ˆì‹œì— ê°¯ìˆ˜ì— ë”°ë¼, ì˜ˆì‹œë¥¼ í•œ ê°œë„ ì£¼ì§€ ì•Šê³  ì˜¤ì§ ì§€ì‹œë¬¸ìœ¼ë¡œë§Œ êµ¬ì„±í•˜ëŠ” ê²½ìš°ë¥¼ Zero-Shot, ì˜ˆì‹œë¥¼ í•œ ê°œë§Œ ì œê³µí•˜ëŠ” ê²½ìš°ë¥¼ One-Shot, ì—¬ëŸ¬ ê°œì˜ ì˜ˆì‹œë¬¸ì„ ì œê³µí•˜ëŠ” ê²½ìš°ëŠ” Few-Shot ì´ë¼ê³  í•œë‹¤. Few Shot Promptì˜ ê²½ìš° <code>FewShotPromptTemplate</code> í´ë˜ìŠ¤ë¥¼ í™œìš©í•  ìˆ˜ ìˆë‹¤.</p><h3 id="few-shot-prompt-template" tabindex="-1">Few Shot Prompt Template <a class="header-anchor" href="#few-shot-prompt-template" aria-label="Permalink to &quot;Few Shot Prompt Template&quot;">â€‹</a></h3><p>Few Shot Prompt Template ê°ì²´ëŠ” ì—¬ëŸ¬ ê°œì˜ ì§ˆë¬¸-ë‹µë³€ ë¦¬ìŠ¤íŠ¸ì™€ ì§ˆë¬¸ ë‹µë³€ì„ í¬ë§·íŒ… í•  í”„ë¡¬í”„íŠ¸, ê·¸ë¦¬ê³  ìƒì„±í˜• aiì—ê²Œ ì§ˆë¬¸ í•  ë‚´ìš©ì˜ ë¬¸ì¥ í˜•ì‹(suffix)ë¥¼ ë§¤ê°œ ë³€ìˆ˜ë¡œ êµ¬ì„±ëœë‹¤.</p><p>ìš°ì„  ì˜ˆì‹œ QA ì„¸íŠ¸ë¥¼ ìƒì„±í•œë‹¤. QA ì„¸íŠ¸ëŠ” { Question : ì§ˆì˜ì–´, Answer : ë‹µë³€êµ¬ì„± } ìœ¼ë¡œ êµ¬ì„±ëœ ë”•ì…”ë„ˆë¦¬ë“¤ì˜ ë¦¬ìŠ¤íŠ¸ë¡œ êµ¬ì„±í•œë‹¤. ë‹µë³€ì€ ì§ˆì˜ì–´ì— ëŒ€í•œ ë‹µë³€ì„ ì—¬ëŸ¬ ë‹¨ê³„ì— ê±¸ì³ ìƒì„±í•˜ë„ë¡(ì¶”ê°€ì§ˆë¬¸-ì¤‘ê°„ë‹µë³€ í˜•ì‹ìœ¼ë¡œ) ì˜ˆì‹œë¥¼ ì‘ì„±í•œë‹¤.</p><details class="details custom-block"><summary>Example Prompts</summary><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">examples </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;question&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Heart2Heartì™€ ì•„ì´ë¸Œì˜ ë©¤ë²„ ìˆ˜ê°€ ê°™ë‚˜ìš”?&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;answer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;&quot;ì´ ì§ˆë¬¸ì— ì¶”ê°€ ì§ˆë¬¸ì´ í•„ìš”í•œê°€ìš”: ì˜ˆ.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ì¶”ê°€ ì§ˆë¬¸ : Heart2Heartì˜ ë©¤ë²„ ìˆ˜ëŠ” ëª‡ ëª…ì¸ê°€ìš”?</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ì¤‘ê°„ ë‹µë³€ : Heart2Heartì˜ ë©¤ë²„ ìˆ˜ëŠ” 8ëª…ì…ë‹ˆë‹¤.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ì¶”ê°€ ì§ˆë¬¸ : ì•„ì´ë¸Œì˜ ë©¤ë²„ ìˆ˜ëŠ” ëª‡ ëª…ì¸ê°€ìš”?</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ì¤‘ê°„ ë‹µë³€ : ì•„ì´ë¸Œì˜ ë©¤ë²„ ìˆ˜ëŠ” 6ëª…ì…ë‹ˆë‹¤. ë”°ë¼ì„œ ë‘ ê·¸ë£¹ì˜ ë©¤ë²„ ìˆ˜ê°€ ë‹¤ë¦…ë‹ˆë‹¤.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ìµœì¢… ë‹µë³€ì€ : ì•„ë‹ˆì˜¤.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;question&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;(ì—¬ì)ì•„ì´ë“¤ì˜ ë¯¼ë‹ˆì™€ ê°™ì€ êµ­ê°€ ì¶œì‹ ì¸ ì—¬ì ì•„ì´ëŒì€ ëˆ„êµ¬ì¸ê°€ìš”?&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;answer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;&quot;ì´ ì§ˆë¬¸ì— ì¶”ê°€ ì§ˆë¬¸ì´ í•„ìš”í•œê°€ìš”: ì˜ˆ.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ì¶”ê°€ ì§ˆë¬¸ : (ì—¬ì)ì•„ì´ë“¤ì˜ ë¯¼ë‹ˆëŠ” ì–´ëŠ êµ­ê°€ ì¶œì‹ ì¸ê°€ìš”?</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ì¤‘ê°„ ë‹µë³€ : (ì—¬ì)ì•„ì´ë“¤ì˜ ë¯¼ë‹ˆëŠ” íƒœêµ­ ì¶œì‹ ì…ë‹ˆë‹¤.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ì¶”ê°€ ì§ˆë¬¸ : íƒœêµ­ ì¶œì‹ ì˜ ì•„ì´ëŒë¡œëŠ” ëˆ„ê°€ ìˆë‚˜ìš”?</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ì¤‘ê°„ ë‹µë³€ : íƒœêµ­ ì¶œì‹ ì˜ ì•„ì´ëŒë¡œëŠ” 2PMì˜ ë‹‰ì¿¤ê³¼ ë¸”ë™í•‘í¬ì˜ ë¦¬ì‚¬ê°€ ìˆìŠµë‹ˆë‹¤.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ì¶”ê°€ ì§ˆë¬¸ : 2PMê³¼ ë¸”ë™í•‘í¬ ì¤‘ ì—¬ì ì•„ì´ëŒ ê·¸ë£¹ì€ ë¬´ì—‡ì¸ê°€ìš”?</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ì¤‘ê°„ ë‹µë³€ : ì—¬ì ì•„ì´ëŒ ê·¸ë£¹ì€ ë¸”ë™ í•‘í¬ì…ë‹ˆë‹¤. </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ìµœì¢… ë‹µë³€ì€ : ë¸”ë™í•‘í¬ì˜ ë¦¬ì‚¬&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;question&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2024-2025ë…„ì— SM, JYP, YG, HYBEì—ì„œ ë°ë·”í•œ ì•„ì´ëŒ ê·¸ë£¹ ì¤‘ ë©¤ë²„ ì „ì›ì´ í•œêµ­ì¸ì¸ ê·¸ë£¹ì´ ìˆë‚˜ìš”?&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;answer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;&quot;ì´ ì§ˆë¬¸ì— ì¶”ê°€ ì§ˆë¬¸ì´ í•„ìš”í•œê°€ìš”: ì˜ˆ.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ì¶”ê°€ ì§ˆë¬¸ : 2024-2025ë…„ì— SM, JYP, YG, HYBE ì†Œì†ì˜ ë°ë·” ì•„ì´ëŒ ê·¸ë£¹ì€?</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ì¤‘ê°„ ë‹µë³€ : IILIT, Babymonster, Hearts2Hearts,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ì¶”ê°€ ì§ˆë¬¸ : IILIT ë©¤ë²„ë“¤ì˜ êµ­ì ì€?</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ì¤‘ê°„ ë‹µë³€ : í•œêµ­, ì¼ë³¸</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ì¶”ê°€ ì§ˆë¬¸ : Babymonster ë©¤ë²„ë“¤ì˜ êµ­ì ì€?</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ì¤‘ê°„ ë‹µë³€ : í•œêµ­, ì¼ë³¸</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ì¶”ê°€ ì§ˆë¬¸ : Hearts2Hearts ë©¤ë²„ë“¤ì˜ êµ­ì ì€?</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ì¤‘ê°„ ë‹µë³€ : í•œêµ­, í˜¸ì£¼, ì¸ë„ë„¤ì‹œì•„</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ìµœì¢… ë‹µë³€ì€ : 2024-2025ë…„ì— ë°ë·”í•œ SM, JYP, HYBE, YG ì†Œì† ì•„ì´ëŒ ê·¸ë£¹ ì¤‘ ë©¤ë²„ ì „ì›ì´ í•œêµ­ì¸ì¸ ê·¸ë£¹ì€ ì—†ìŠµë‹ˆë‹¤.&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div></details><p>ê·¸ ë‹¤ìŒì—ëŠ” ì˜ˆì‹œ í”„ë¡¬í”„íŠ¸ë“¤ì„ <code>PromptTemplate</code> í´ë˜ìŠ¤ í˜•ì‹ìœ¼ë¡œ ìƒì„±í•  ìˆ˜ ìˆë„ë¡ example templateì„ ì •ì˜í•œë‹¤.</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">example_template </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PromptTemplate.from_template(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;Question : </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n{question}\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Answer:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n{answer}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>ì˜ˆì‹œë¬¸ê³¼ ì˜ˆì‹œë¬¸ êµ¬ì„±ì„ ìœ„í•œ í…œí”Œë¦¿ ì •ì˜ê°€ ëë‚¬ìœ¼ë©´, <code>FewShotPromptTemplate</code> í´ë˜ìŠ¤ë¡œ ì²´ì¸ì— ì‚¬ìš©í•  í”„ë¡¬í”„íŠ¸ë¥¼ ì •ì˜í•œë‹¤. <code>suffix</code>ëŠ” ì…ë ¥ ì§ˆë¬¸ì— ëŒ€í•œ í˜•ì‹ì„ ì •ì˜í•œë‹¤.</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">few_shot_prompt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> FewShotPromptTemplate(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    examples</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">examples,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    example_template</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">example_template,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    suffix</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Question:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n{question}\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Answer:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    input_variables</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[question]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">chain </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> few_shot_prompt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">llm</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">StrOutputParser()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">chat </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> chain.stream({</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;question&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;íŒ€ ë‚´ ë§‰ë‚´ê°€ 2008ë…„ ìƒì¸ ì•„ì´ëŒ ê·¸ë£¹ì€?&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="example-selector" tabindex="-1">Example Selector <a class="header-anchor" href="#example-selector" aria-label="Permalink to &quot;Example Selector&quot;">â€‹</a></h3><p>ì˜ˆì œê°€ ë„ˆë¬´ ë§ê³ , ì˜ˆì œì˜ ë‚´ìš©ì´ë‚˜ ì£¼ì œê°€ ë‹¤ì–‘í•œ ê²½ìš°ì—ëŠ” example selectorë¥¼ í™œìš©í•˜ì—¬, ì°¸ê³ í•  ì˜ˆì‹œ ëª‡ ê°œë§Œ ê³ ë¥¼ ìˆ˜ ìˆë‹¤. ì˜ˆì œë¬¸ë„ ì„ë² ë”©ì‹œì¼œ ë²¡í„°ìŠ¤í† ì–´ì— ì €ì¥í•´ì•¼ í•˜ë¯€ë¡œ, ë²¡í„° db ê°ì²´ì™€ ì„ë² ë”© ëª¨ë¸ì´ ë¯¸ë¦¬ ì •ì˜ë˜ì–´ ìˆì–´ì•¼ í•œë‹¤.</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">example_selector </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SemanticSimilarityExampleSelector.from_examples(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    example,    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ì˜ˆì‹œë¬¸ ë¦¬ìŠ¤íŠ¸</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    EmbeddingModel, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ì„ë² ë”© ëª¨ë¸ ê°ì²´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    VectorStoreObj,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ì•ì„œ ì •ì˜í•œ ë²¡í„° ìŠ¤í† ì–´ ê°ì²´</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    k</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # ìƒì„±í•  ì˜ˆì‹œ ê°œìˆ˜</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">selected_example </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> example_selector.select_example({</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;question&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : question})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>ì±—ë´‡ í™˜ê²½ì—ì„œ ì´ê²ƒì„ í™œìš©í•˜ê³ ì í•œë‹¤ë©´, 1. example sampleì„ ì„ ì •í•˜ì—¬ ë¦¬í„´í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì •ì˜í•˜ê³ , 2. ì´ í•¨ìˆ˜ë¥¼ Runnable ê°ì²´ë¡œ ì •ì˜í•˜ì—¬ ì²´ì¸ì—ì„œ ì‚¬ìš©í•´ì•¼ í•œë‹¤. ì´ë•Œ ì•ì„œ ì–¸ê¸‰í•œ <code>RunnableLambda</code>ê°€ ì‚¬ìš©ëœë‹¤.</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># example_selectorë¥¼ ì‚¬ìš©ì í•¨ìˆ˜ë¡œ ì •ì˜í•œë‹¤.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_few_shot_prompt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(question):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    chosen_examples </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> example_selector.select_examples({</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;question&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:question})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    prompt_tempolate </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> FewShotPromptTemplate(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        examples</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">chosen_examples,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        example_prompt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">example_prompt,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        suffix</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Question: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{input}\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Answer:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        input_variables</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;input&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [prompt_template.invoke({</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;input&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : question}).text] </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ì„ ì •ëœ ì˜ˆì‹œë¬¸ì„ ë¦¬ìŠ¤íŠ¸ í˜•ì‹ìœ¼ë¡œ ë°›ì•„ì˜¨ë‹¤.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prompt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ChatPromptTemplate.from_messages(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;system&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ë„ˆëŠ” í•œêµ­ì˜ k-pop ì•„ì´ëŒì— ëŒ€í•œ ì§ˆì˜ ì‘ë‹µì„ ìˆ˜í–‰í•˜ëŠ” ì±—ë´‡ì´ì•¼.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        MessagePlaceHolder(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">variable_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;chat_history&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># history ê´€ë ¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        MessagePlaceHolder(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">variable_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;examples&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;human&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ë‹¤ìŒì˜ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì°¸ê³ í•˜ì—¬ ì£¼ì–´ì§„ ì§ˆë¬¸ì— ëŒ€í•œ ë‹µì„ í•˜ì‹œì˜¤</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&lt;context&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{context}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&lt;/context&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&lt;question&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{question}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&lt;/question&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">chain </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;context&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : itemgetter(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;question&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">retriever,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;examples&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : itemgetter(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;question&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RunnableLambda(get_few_shot_prompt),</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;question&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> :itemgetter(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;question&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;chat_history&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : itemgetter(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;chat_history&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prompt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">llm</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">StrOutputParser()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>í•˜ì§€ë§Œ, ë§¤ìš° ê°„ë‹¨í•˜ê²Œ <code>FewShotChatMessagePromptTemplate</code> ê°ì²´ë¥¼ í”„ë¡¬í”„íŠ¸ë¡œ ì •ì˜í•˜ì—¬ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ë„ ìˆë‹¤.</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#few-shot chat message prompt ì •ì˜</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">few_shot_prompt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> FewShotChatMessagePromptTemplate(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    example_sampler</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> example_sampler,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    example_prompt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> example_prompt,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># chain í•  ìµœì¢… í”„ë¡¬í”„íŠ¸ ì •ì˜</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">final_prompt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ChatPromptTemplate.from_messages(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;system&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ë„ˆëŠ” K-POP ì•„ì´ëŒì— ëŒ€í•œ ì§ˆì˜ ì‘ë‹µì„ ìˆ˜í–‰í•˜ëŠ” ì±—ë´‡ì´ì•¼.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        few_shot_prompt,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;human&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Question:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n{question}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>example selectorëŠ” ë‹¨ìˆœ question-answer ì˜ˆì‹œë³´ë‹¤, intruction-input-answer ì˜ˆì‹œì— ìœ ìš©í•˜ë‹¤.</p><details class="details custom-block"><summary>Instruction-Input ì˜ˆì‹œ</summary><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">instruction_examples </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;instruction&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ë‹¤ìŒì˜ ë‚´ìš©ì„ ë” ì‚¬ë¬´ì ì¸ í˜•ì‹ì˜ ì´ë©”ì¼ë¡œ ë°”ê¿”ì¤˜&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;input&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ë‚´ì¼ íšŒì˜ ì˜¤ì°¬ ì¥ì†Œê°€ 201ê´€ 1ì¸µ ì‹ë‹¹ì—ì„œ 101ê´€ 11ì¸µ ì‹ë‹¹ìœ¼ë¡œ ë³€ê²½ëìŠµë‹ˆë‹¤. íšŒì˜ì‹¤ ì…ì¥ ì‹œ ì‹ê¶Œì´ ì œê³µë˜ë‹ˆ, ì‹ê¶Œì„ ì§€ì°¸í•˜ì—¬ ë°©ë¬¸í•´ì£¼ì„¸ìš”.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;answer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ì´ë©”ì¼ ì œëª© : [íšŒì˜ëª…]íšŒì˜ ì˜¤ì°¬ ì¥ì†Œê°€ ë³€ê²½ë˜ì—ˆìŒì„ ê³µì§€í•©ë‹ˆë‹¤.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ì´ë©”ì¼ ë‚´ìš© : </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ì•ˆë…•í•˜ì„¸ìš”. íšŒì˜ ì£¼ìµœì‚¬ OOOOì˜ ë‹´ë‹¹ì OOOì…ë‹ˆë‹¤.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ë‚´ì¼ (3/7) ì§„í–‰ë  íšŒì˜ì˜ ì˜¤ì°¬ ì¥ì†Œê°€ 201ê´€ 1ì¸µ ì‹ë‹¹ì—ì„œ 101ê´€ 11ì¸µ ì‹ë‹¹ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŒì„ ê³µì§€í•©ë‹ˆë‹¤.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        íšŒì˜ì‹¤ ì…ì¥ ì‹œ ì‹ê¶Œì„ ì§€ê¸‰í•˜ë©°, í•´ë‹¹ ì‹ê¶Œì„ ì§€ì°¸í•˜ì—¬ ì‹ì‚¬í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ë‚´ì¼ ëµ™ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ê°ì‚¬í•©ë‹ˆë‹¤.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;instruction&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ë‹¤ìŒì˜ ë‚´ìš©ìœ¼ë¡œ ê³ ê°ì—ê²Œ ë³´ë‚¼ ì‚¬ê³¼ë¬¸ì„ ì‘ì„±í•´ì¤˜,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;input&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ì‹¤ìˆ˜ë¡œ ì˜¤ë°°ì†¡ í•´ì„œ ì£„ì†¡í•©ë‹ˆë‹¤. ì‚¬ì£„ì˜ ì˜ë¯¸ë¡œ ê³ ê°ë‹˜ ê³„ì •ìœ¼ë¡œ 2000í¬ì¸íŠ¸ë¥¼ ì§€ê¸‰í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. ì¬ë°œ ë°©ì§€ë¥¼ ìœ„í•´ ëª¨ë‹ˆí„°ë§ì„ ê°•í™”í•˜ê² ìŠµë‹ˆë‹¤.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;answer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        OOO ê³ ê°ë‹˜, ì˜¤ë°°ì†¡ ë¬¸ì œë¡œ ë¶í¸ì„ ê²ªê²Œ í•´ì„œ ì£„ì†¡í•©ë‹ˆë‹¤. </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ë³¸ì‚¬ì—ì„œëŠ” ì¬ë°œ ë°©ì§€ë¥¼ ìœ„í•´ ëª¨ë‹ˆí„°ë§ ì ˆì°¨ë¥¼ ê°•í™”í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ë‹¤ì‹œ í•œë²ˆ ê¹Šì€ ì‚¬ì£„ì˜ ë§ì”€ì„ ë“œë¦¬ë©°, ì´ë²ˆ ì˜¤ë°°ì†¡ì— ëŒ€í•œ ë³´ìƒìœ¼ë¡œ 2000pointë¥¼ ê³ ê°ë‹˜ ê³„ì •ìœ¼ë¡œ ì§€ê¸ˆí•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ê³ ê°ë‹˜ì˜ í”¼ë“œë°±ì„ í†µí•´ ë” ë‚˜ì€ OOOì´ ë  ìˆ˜ ìˆë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div></details><p>example promptì™€ chainì— ìµœì¢…ì ìœ¼ë¡œ ë“¤ì–´ê°ˆ í”„ë¡¬í”„íŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤.</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">instruction_example_prompt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ChatPromptTemplate.from_messages(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;human&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Instruction:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{instruction}\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Input:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{input}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ai&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Answer : </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{answer}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">instruction_few_shot_prompt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> FewShotChatMessagesPromptTemplate(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    example_selector</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">example_sampler,</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># instruction ì…ë ¥ì— ë§ëŠ” ë‹¤ë¥¸ samplerë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì¶”ì²œ</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    example_prompt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">instruction_example_prompt</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">final_prompt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ChatPromptTemplate.from_messages(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;system&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ë„ˆëŠ” ì‚¬ë¬´ ì—…ë¬´ë¥¼ ë³´ì¡°í•˜ëŠ” ì±—ë´‡ì´ì•¼.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        instruction_few_shot_prompt,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;human&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Instruction:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{instruction}\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Input:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{input}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>ìœ„ ì½”ë“œì˜ ì£¼ì„ìœ¼ë¡œ ë‹¬ì•„ ë†“ì•˜ë“¯ì´, instruction ì˜ ìœ í˜•ì— ë”°ë¼ ì˜ˆì‹œë¬¸ì„ ì„ íƒí•´ì•¼ í•˜ë¯€ë¡œ ê¸°ì¡´ì˜ ë‹¨ìˆœ ìœ ì‚¬ë„ ê¸°ë°˜ example selectorëŠ” ë¹„íš¨ìœ¨ì ì´ë‹¤.</p><p>ë”°ë¼ì„œ, ê°œì¸ì´ ì§ì ‘ example selectorë¥¼ ë§Œë“¤ì–´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤. ì•„ë˜ì˜ ì˜ˆì‹œì—ì„œëŠ” <code>CustomExampleSelector</code> í´ë˜ìŠ¤ë¥¼ ìƒˆë¡œ ì •ì˜í•˜ì—¬ instruction ì˜ ìœ ì‚¬ë„ë§Œì„ ë¹„êµí•˜ì—¬ ì˜ˆì‹œë¥¼ ì„ íƒí•˜ëŠ” example selector ê°ì²´ë¥¼ ë§Œë“¤ì—ˆë‹¤. <a href="https://python.langchain.com/v0.1/docs/modules/model_io/prompts/example_selectors/" target="_blank" rel="noreferrer">ì—¬ê¸°</a>ë¥¼ ì°¸ê³ í•˜ë©´ ë” ì •í™•í•˜ê³  ìì„¸í•œ ì„¤ëª…ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ë¶€ëª¨ í´ë˜ìŠ¤ë¡œ BaseExampleSelector í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ì•„ì•¼ í•œë‹¤.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">## ê·¸ë ‡ê²Œ í•˜ì§€ ì•Šìœ¼ë©´ FewShotChatMessagePromptTemplate ì—ì„œ ì¸ì‹ì´ ì•ˆë¨</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> langchain_core.example_selectors.base </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> BaseExampleSelector</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CustomExampleSelector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">BaseExampleSelector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    def</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> __init__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self, example_list):</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.example_list</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">example_list  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ì˜ˆì‹œë¬¸ ë¦¬ìŠ¤íŠ¸ë¥¼ ë°›ì•„ì˜¨ë‹¤</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # ì˜ˆì‹œë¬¸ ë¦¬ìŠ¤íŠ¸ì—ì„œ ì§€ì‹œë¬¸ë§Œ ë”°ë¡œ ì¶”ë ¤ì˜¨ë‹¤</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.instructions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;instruction&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : x[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;instruction&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> example_list]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # ì§€ì‹œë¬¸ ë¦¬ìŠ¤íŠ¸ì—ì„œ ì…ë ¥ëœ ì§€ì‹œë¬¸ê³¼ ê°€ì¥ ìœ ì‚¬í•œ ë¬¸ì¥ì„ ì°¾ë„ë¡ í•œë‹¤.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.instruction_selector </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SemanticSimilarityExampleSelector.from_examples(</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.instructions,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ì§€ì‹œë¬¸ ë¦¬ìŠ¤íŠ¸ì˜ ìœ ì‚¬ë„ë§Œ ë¹„êµí•œë‹¤.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            bge_m3, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ì„ë² ë”© ëª¨ë¸</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            chroma, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ë²¡í„° ìŠ¤í† ì–´</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">            k</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # ë‘ ê°œë§Œ ê°€ì ¸ì˜¤ë„ë¡ í•œë‹¤.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        )</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # !! í•„ìˆ˜ ì •ì˜ !!</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> select_examples</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self, context):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.get_instruction_sample(context)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # !! í•„ìˆ˜ ì •ì˜ !!</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> add_example</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self, example):</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.example_list.append(example)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # ê°€ì¥ ìœ ì‚¬ë„ê°€ ë†’ì€ ì§€ì‹œë¬¸ì„ ê°€ì§„ ì˜ˆì‹œ ë”•ì…”ë„ˆë¦¬ë¥¼ ë¦¬í„´í•˜ë„ë¡ í•œë‹¤.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # inputì€ {&quot;instruction&quot; : , &quot;input&quot; :} ê¼´ì˜ ë”•ì…”ë„ˆë¦¬</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_instruction_sample</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self, context):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ex_instruction_list</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.instruction_selector.select_examples({</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;instruction&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:context[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;instruction&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ex_sam_list </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> searched </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ex_instruction_list:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ex </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.example_list:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> searched[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;instruction&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ex[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;instruction&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                    ex_sam_list.append(ex)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ex_sam_list</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>ì¼ë°˜ì ì¸ example selectorë¥¼ ì“°ëŠ” ê²ƒê³¼ ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ chainì— ë“¤ì–´ê°ˆ í”„ë¡¬í”„íŠ¸ë¥¼ ì •ì˜í•˜ë©´ ëœë‹¤.</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">instruction_selector </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CustomExampleSelector(instrucion_list)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">instruction_few_shot_prompt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> FewShotChatMessagePromptTemplate(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    example_selector</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">instruction_selector,</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># instruction ì…ë ¥ì— ë§ëŠ” ë‹¤ë¥¸ samplerë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì¶”ì²œ</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    example_prompt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">instruction_example_prompt</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">final_prompt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ChatPromptTemplate.from_messages(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;system&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ë„ˆëŠ” ì‚¬ë¬´ ì—…ë¬´ë¥¼ ë³´ì¡°í•˜ëŠ” ì±—ë´‡ì´ì•¼.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        instruction_few_shot_prompt,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;human&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Instruction:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{instruction}\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Input:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{input}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><code>.invoke</code>ë¥¼ ì‚¬ìš©í•  ë•ŒëŠ” {&quot;instruction&quot; : val, &quot;input&quot; : val} í˜•ì‹ìœ¼ë¡œ ë„£ì–´ì¤€ë‹¤.</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">few_shot_chain </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> final_prompt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">qwen</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">StrOutputParser()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">answer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> few_shot_chain.invoke({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;instruction&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;êµìˆ˜ë‹˜ê»˜ ë³´ë‚¼ ì´ë©”ì¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;input&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;êµìˆ˜ë‹˜ ì œê°€ ì˜¤ëŠ˜ ì½”ë¡œë‚˜ì— ê±¸ë ¤ì„œ ë‚´ì¼ ì¶œì„ ëª»í• ê²ƒê°™ì•„ìš”&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    })</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(answer)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>ì´ë ‡ê²Œ í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ë‹µë³€ì„ ì–»ì„ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>Answer :</span></span>
<span class="line"><span>ì´ë©”ì¼ ì œëª©: ì˜¤ëŠ˜ ì½”ë¡œë‚˜ ê°ì—¼ìœ¼ë¡œ ì¸í•œ ë‚´ì¼ ìˆ˜ì—… ê²°ì„ ì‹ ê³ </span></span>
<span class="line"><span></span></span>
<span class="line"><span>ì•ˆë…•í•˜ì„¸ìš”, êµìˆ˜ë‹˜. OOOO êµìˆ˜ë‹˜ê»˜ ê±´ê°• ê´€ë ¨ ì‚¬í•­ì„ ë§ì”€ë“œë¦½ë‹ˆë‹¤.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ì˜¤ëŠ˜ ì½”ë¡œë‚˜ì— ê°ì—¼ë˜ì–´ ë‚´ì¼ ìˆ˜ì—…ì— ì°¸ì„í•˜ì§€ ëª»í•  ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤. í˜¹ì‹œ ìˆ˜ì—… ìë£Œë‚˜ ê°•ì˜ ë‚´ìš©ì„ ì œê³µí•´ì£¼ì‹¤ ìˆ˜ ìˆìœ¼ì‹ ì§€ ì•Œë ¤ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ê¸°ì €ì§ˆí™˜ì€ ì—†ìœ¼ë‚˜, ê°ì—¼ ë˜ì—ˆìŒì„ í™•ì¸í•œ í›„ ì•ˆì „ì„ ìœ„í•´ ìê°€ê²©ë¦¬ë¥¼ ì‹¤ì‹œí•˜ê² ìŠµë‹ˆë‹¤. ê±´ê°• ìƒíƒœê°€ ê°œì„ ë  ê²½ìš° ì¦‰ì‹œ êµìˆ˜ë‹˜ê»˜ ì—°ë½ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ê°ì‚¬í•©ë‹ˆë‹¤.</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>ê°ì‚¬í•©ë‹ˆë‹¤.</span></span>
<span class="line"><span>[ë‹¹ì‹ ì˜ ì´ë¦„] ë“œë¦¼</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>ì¡°ê¸ˆ ë²ˆì—­ì²´ê¸´ í•˜ì§€ë§Œ ë­”ê°€ ê·¸ëŸ´ì‹¸í•œê²Œ ë‚˜ì˜¤ê¸´ í–ˆë‹¤.</p>`,56),l=[e];function t(h,k,r,E,d,o){return a(),i("div",null,l)}const g=s(p,[["render",t]]);export{u as __pageData,g as default};
